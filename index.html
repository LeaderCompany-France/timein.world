<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimeIn.World - Current Time in 240+ Cities Worldwide</title>
    <meta name="description" content="Check current time in 240+ cities worldwide. Real-time world clock with time zones, time converter, meeting planner. Available in 12 languages.">
    
    <!-- Script intelligent qui d√©tecte l'environnement -->
    <script>
        // D√©tection automatique de l'environnement
        const isGitHubPages = window.location.hostname.includes('github.io');
        const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        
        // D√©finit le chemin de base selon l'environnement
        let basePath = '';
        if (isGitHubPages) {
            // Sur GitHub Pages : pas de slash
            basePath = '';
        } else if (isLocalhost) {
            // En d√©veloppement local : avec slash
            basePath = '/';
        } else {
            // Sur timein.world (production) : avec slash
            basePath = '/';
        }
        
        // Fonction helper pour cr√©er les chemins
        function getPath(path) {
            if (basePath === '') {
                return path;
            }
            return basePath + path;
        }
        
        // Info de debug (visible dans la console)
        console.log('ü§ñ TimeIn.World - Environnement d√©tect√©:', {
            hostname: window.location.hostname,
            isGitHubPages: isGitHubPages,
            isLocalhost: isLocalhost,
            basePath: basePath || 'racine'
        });
    </script>
    
    <!-- CSS avec chemins dynamiques -->
    <script>
        document.write('<link rel="stylesheet" href="' + getPath('css/main.css') + '">');
        document.write('<link rel="stylesheet" href="' + getPath('css/themes.css') + '">');
    </script>
    
    <!-- Favicon -->
    <link rel="icon" href="favicon.ico">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="TimeIn.World - World Clock">
    <meta property="og:description" content="Check current time in 240+ cities worldwide">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://timein.world">
    <meta property="og:image" content="https://timein.world/images/og-image.jpg">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="TimeIn.World - World Clock">
    <meta name="twitter:description" content="Check current time in 240+ cities worldwide">
    
    <!-- Schema.org pour SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "TimeIn.World",
        "description": "World clock showing current time in 240+ cities with time converter and meeting planner",
        "url": "https://timein.world",
        "applicationCategory": "UtilityApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "1024"
        }
    }
    </script>
</head>
<body>
    <!-- Message de chargement avec d√©tection d'environnement -->
    <div id="app">
        <div class="loading">
            <h2>Loading TimeIn.World...</h2>
            <div class="spinner"></div>
            <noscript>
                <p style="color: red;">‚ö†Ô∏è JavaScript is required for this application to work.</p>
            </noscript>
        </div>
    </div>

    <!-- Scripts avec chemins dynamiques -->
    <script>
        // Chargement intelligent des scripts
        const scripts = [
            'js/cities-data.js',
            'js/translations.js',
            'js/app.js',
            'js/router.js',
            'js/city-content-generator.js'
        ];
        
        // Fonction pour charger un script
        function loadScript(src, callback) {
            const script = document.createElement('script');
            script.src = getPath(src);
            script.onload = callback;
            script.onerror = function() {
                console.error('‚ùå Erreur de chargement:', src);
                // Tentative avec l'autre format de chemin
                script.src = src; // Essai sans le basePath
            };
            document.body.appendChild(script);
        }
        
        // Chargement s√©quentiel des scripts
        let scriptIndex = 0;
        function loadNextScript() {
            if (scriptIndex < scripts.length) {
                loadScript(scripts[scriptIndex], function() {
                    console.log('‚úÖ Charg√©:', scripts[scriptIndex]);
                    scriptIndex++;
                    loadNextScript();
                });
            } else {
                // Tous les scripts sont charg√©s, initialiser l'app
                console.log('üöÄ Initialisation de TimeIn.World...');
                if (typeof initRouter !== 'undefined') {
                    initRouter();
                } else {
                    console.error('‚ùå initRouter non trouv√©');
                }
            }
        }
        
        // D√©marrer le chargement
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üì± DOM charg√©, d√©marrage du chargement des scripts...');
            loadNextScript();
        });
        
        // Gestion d'erreur globale (pour debug)
        window.addEventListener('error', function(e) {
            console.error('‚ùå Erreur globale:', e.message, e.filename, e.lineno);
        });
    </script>
    
    <!-- Fallback pour les navigateurs tr√®s anciens -->
    <script>
        // Test de compatibilit√©
        if (!window.localStorage || !window.JSON) {
            document.getElementById('app').innerHTML = 
                '<div style="padding: 20px; text-align: center;">' +
                '<h2>‚ö†Ô∏è Browser Not Supported</h2>' +
                '<p>Please update your browser to use TimeIn.World</p>' +
                '</div>';
        }
    </script>
    
    <!-- Analytics (si vous en avez) -->
    <script>
        // Placeholder pour Google Analytics ou autre
        // D√©tection de l'environnement pour √©viter de compter les tests
        if (!isGitHubPages && !isLocalhost) {
            console.log('üìä Analytics activ√© (production)');
            // Votre code analytics ici
        } else {
            console.log('üìä Analytics d√©sactiv√© (test/dev)');
        }
    </script>
</body>
</html>
